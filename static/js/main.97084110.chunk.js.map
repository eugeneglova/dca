{"version":3,"sources":["functions.js","TableEdit.js","App.js","index.js"],"names":["getDecimals","value","precision","decimals","Math","floor","getCost","p","a","getPositionPL","entryPrice","exitPrice","amount","fee","pl","exitFee","abs","getPositionPLPercent","cost","positiveAmount","max","getPositionCost","getPosition","pp","pa","op","oa","getPosPrice","plp","id","_","uniqueId","price","getPercentPrice","percent","parseFloat","getNextPrice","xPrice","sign","index","log10","getNextAmount","xAmount","getAvgPosition","orders","maxIndex","length","reduce","acc","order","isEmpty","getOrderRows","entryAmount","pricePercent","rows","endPrice","push","getRowId","row","FocusableCell","onClick","restProps","Cell","tabIndex","onFocus","TableEdit","initRows","columns","onChange","useState","setRows","editingCells","setEditingCells","useEffect","commitChanges","changedRows","added","changed","deleted","startingAddedId","map","deletedSet","Set","filter","has","onCommitChanges","onEditingCellsChange","addedRows","onAddedRowsChange","cellComponent","selectTextOnEditStart","showAddCommand","showDeleteCommand","App","symbol","xPositionAmount","settings","setSettings","orderRows","setOrderRows","pos","getPlRows","plRows","setPlRows","settingsColumns","name","title","getCellValue","data","JSON","parse","prompt","positionRows","positions","position","pair","status","basePrice","newOrderRows","all","slice","type","concat","flags","String","stringify","meta","isPublic","throttle","payload","join","getOrders","console","log","copy","indexOf","prevPrice","diff","diffPercent","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"qNAEMA,EAAc,SAACC,GACnB,OAAIA,EAAQ,EAAU,EAClBA,EAAQ,IAAa,EACrBA,EAAQ,IAAc,EACnB,GAGIC,EAAY,SAACD,GAAD,IAAQE,EAAR,uDAAmBH,EAAYC,GAA/B,OACvBG,KAAKC,MAAMJ,EAAK,SAAG,GAAME,IAAzBC,KAAA,IAAqC,GAAMD,IAEvCG,EAAU,SAACC,EAAGC,GAAJ,OAAUN,EAAUK,EAAIC,IAG3BC,EAAgB,SAACC,EAAYC,EAAWC,EAAQC,GAC3D,IAAMC,GAAMH,EAAYD,GAAcE,EAChCG,EAAUJ,EAAYP,KAAKY,IAAIJ,GAAUC,EAC/C,OAAOX,EAAUY,EAAKC,IAWXE,EAAuB,SAACP,EAAYC,EAAWC,GAC1D,IAAME,EAAKL,EAAcC,EAAYC,EAAWC,EAAQ,GAClDM,EAVgB,SAACR,EAAYC,EAAWC,GAC9C,IAAMO,EAAiBf,KAAKY,IAAIJ,GAChC,OAAIA,EAAS,EACJR,KAAKgB,IAAID,EAAiBT,EAAYS,EAAiBR,EAAW,GAEpEP,KAAKgB,IAAID,EAAiBT,EAAY,GAKhCW,CAAgBX,EAAYC,EAAWC,GACpD,OAAOE,GAAe,IAATI,EAAcJ,EAAKI,EAAQ,IAAM,GAGnCI,EAAc,SAACC,EAAIC,EAAIC,EAAIC,GACtC,IAAMnB,EAvBY,SAACgB,EAAIC,EAAIC,EAAIC,GAAb,OAAoBxB,GAAWI,EAAQiB,EAAIC,GAAMlB,EAAQmB,EAAIC,KAAQF,EAAKE,IAuBlFC,CAAYJ,EAAIC,EAAIC,EAAIC,GAC5BlB,EAAIN,EAAUsB,EAAKE,GACnBZ,EAAKL,EAAcF,EAAGkB,EAAIjB,EAAG,MAC7BoB,EAAM1B,EAAUe,EAAqBV,EAAGkB,EAAIjB,IAClD,MAAO,CACLqB,GAAIC,IAAEC,WACNC,MAAOzB,EACPK,OAAQJ,EACRiB,KACAC,KACAZ,KACAc,QAISK,EAAkB,SAACvB,EAAYwB,GAAb,OAC7BhC,EAAUiC,WAAWzB,GAAcyB,WAAWzB,IAAeyB,WAAWD,GAAW,OAI/EE,EAAe,SAACJ,EAAOK,EAAQC,EAAMC,GACzC,OAAOrC,EAAU8B,EAAQM,EAAON,EAAQK,EAASjC,KAAKoC,MAAoB,KAAbD,EAAQ,MAGjEE,EAAgB,SAAC7B,EAAQ8B,EAASH,GAAlB,OAA4BrC,EAAUU,EAAS8B,IAgBxDC,EAAiB,SAACC,GAAD,IAASC,EAAT,uDAAoBD,EAAOE,OAAS,EAApC,OAC5BF,EAAOG,QAAO,SAACC,EAAKC,EAAOV,GACzB,GAAIA,EAAQM,EAAU,OAAOG,EADM,MAETlB,IAAEoB,QAAQF,GAAO,CAAEhB,MAAO,EAAGpB,OAAQ,GAAMoC,EAA7DhB,EAF2B,EAE3BA,MAAOpB,EAFoB,EAEpBA,OACf,OAAOU,EAAYU,EAAOpB,EAAQuB,WAAWc,EAAMxB,IAAKU,WAAWc,EAAMvB,OACxE,KAsDQyB,EAAe,SAAC,GAa3B,IAPK,IAAD,IALJzC,kBAKI,MALS,OAKT,MAJJ0C,mBAII,MAJU,KAIV,MAHJC,oBAGI,OAHY,GAGZ,MAFJhB,cAEI,MAFK,KAEL,MADJK,eACI,MADM,KACN,EACEY,EAAO,GAETtB,EAAQG,WAAWzB,GACnBE,EAASuB,WAAWiB,GAClBd,EAAOlC,KAAKkC,KAAKe,GACjBE,EAAWtB,EAAgBE,WAAWzB,GAAayB,WAAWkB,IAC7DrB,EAAQM,EAAOA,EAAOiB,GAAU,CACrCD,EAAKE,KAAK,CAAE3B,GAAIC,IAAEC,WAAYN,GAAIO,EAAON,GAAId,IAC7C,IAAM2B,EAAQe,EAAKR,OAAS,EAC5Bd,EAAQI,EAAaJ,EAAOK,EAAQC,EAAMC,GAC1C3B,EAAS6B,EAAc7B,EAAQ8B,GAEjC,OAAOY,G,uCChJHG,EAAW,SAAAC,GAAG,OAAIA,EAAI7B,IAEtB8B,EAAgB,SAAC,GAAD,IAAGC,EAAH,EAAGA,QAAYC,EAAf,kCACpB,kBAAC,IAAMC,KAAP,iBAAgBD,EAAhB,CAA2BE,SAAU,EAAGC,QAASJ,MAqDpCK,MAlDf,YAAsE,IAA3CC,EAA0C,EAAhDZ,KAAgBa,EAAgC,EAAhCA,QAAgC,IAAvBC,gBAAuB,MAAZ,aAAY,IAC3CC,mBAASH,GADkC,mBAC5DZ,EAD4D,KACtDgB,EADsD,OAE3BD,mBAAS,IAFkB,mBAE5DE,EAF4D,KAE9CC,EAF8C,KAInEC,qBAAU,WACRH,EAAQJ,KACP,CAACA,IAEJ,IAAMQ,EAAgB,SAAC,GAAiC,IAClDC,EADmBC,EAA8B,EAA9BA,MAAOC,EAAuB,EAAvBA,QAASC,EAAc,EAAdA,QAEvC,GAAIF,EAAO,CACT,IAAMG,EAAkBzB,EAAKR,OAAS,EAAIQ,EAAKA,EAAKR,OAAS,GAAGjB,GAAK,EAAI,EACzE8C,EAAW,sBACNrB,GADM,YAENsB,EAAMI,KAAI,SAACtB,EAAKnB,GAAN,oBACXV,GAAIkD,EAAkBxC,GACnBmB,QAOT,GAHImB,IACFF,EAAcrB,EAAK0B,KAAI,SAAAtB,GAAG,OAAKmB,EAAQnB,EAAI7B,IAAZ,eAAuB6B,EAAvB,GAA+BmB,EAAQnB,EAAI7B,KAAQ6B,MAEhFoB,EAAS,CACX,IAAMG,EAAa,IAAIC,IAAIJ,GAC3BH,EAAcrB,EAAK6B,QAAO,SAAAzB,GAAG,OAAKuB,EAAWG,IAAI1B,EAAI7B,OAEvDyC,EAAQK,GACRP,EAASO,IAKX,OACE,kBAAC,IAAD,CAAMrB,KAAMA,EAAMa,QAASA,EAASV,SAAUA,GAC5C,kBAAC,IAAD,CACE4B,gBAAiBX,EACjBH,aAAcA,EACde,qBAAsBd,EACtBe,UAAW,GACXC,kBATc,kBAAMd,EAAc,CAAEE,MAAO,CAAC,SAW9C,kBAAC,IAAD,CAAOa,cAAe9B,IACtB,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAwB+B,uBAAqB,IAC7C,kBAAC,IAAD,CAAiBC,gBAAc,EAACC,mBAAiB,MCwBxCC,MAvEf,WAAgB,IAAD,EACmBxB,mBAAS,CACvCxC,GAAI,WACJiE,OAAQ,UACRpF,WAAY,OACZ0C,YAAa,KACbC,cAAe,GACfhB,OAAQ,KACR0D,gBAAiB,EACjBrD,QAAS,MATE,mBACNsD,EADM,KACIC,EADJ,OAWqB5B,mBAASlB,EAAa6C,IAX3C,mBAWNE,EAXM,KAWKC,EAXL,OAYe9B,mBFkJL,SAAC6B,GACxB,IAAME,EAAMzD,EAAeuD,GAC3B,MAAO,CACL,CAAErE,GAAI,QAASG,MAAOoE,EAAIpE,MAAOpB,OAAQwF,EAAIxF,OAAQD,UAAWsB,EAAgBmE,EAAIpE,MAAO,IAC3F,CAAEH,GAAI,QAASG,MAAOoE,EAAIpE,MAAOpB,OAAQwF,EAAIxF,OAAQD,UAAWsB,EAAgBmE,EAAIpE,MAAO,IAC3F,CAAEH,GAAI,QAASG,MAAOoE,EAAIpE,MAAOpB,OAAQwF,EAAIxF,OAAQD,UAAWsB,EAAgBmE,EAAIpE,MAAO,KEvJxDqE,CAAUH,IAZlC,mBAYNI,EAZM,KAYEC,EAZF,KAcb9B,qBAAU,WACR0B,EAAahD,EAAa6C,MACzB,CAACA,IAEJ,IFmD8B1C,EEnDxBkD,EF8BgC,CACtC,CAAEC,KAAM,SAAUC,MAAO,UACzB,CAAED,KAAM,aAAcC,MAAO,eAC7B,CAAED,KAAM,cAAeC,MAAO,gBAC9B,CAAED,KAAM,eAAgBC,MAAO,iBAC/B,CACED,KAAM,QACNC,MAAO,QACPC,aAAc,SAACjD,GAAD,OAASzB,EAAgByB,EAAIhD,WAAYgD,EAAIL,gBAE7D,CAAEoD,KAAM,SAAUC,MAAO,WACzB,CAAED,KAAM,UAAWC,MAAO,aEjC1B,OACE,6BACE,gCACE,yCAEF,kBAAC,EAAD,CACEpD,KAAM,CAAC0C,GACP7B,QAASqC,EACTpC,SAAU,SAAAd,GAAI,OAAI2C,EAAY3C,EAAK,OAErC,gCACE,mDAEF,4BAAQM,QAAS,kBAAMuC,EAAa,MAApC,4BACA,4BACEvC,QAAS,WACP,IAAMgD,EAAOC,KAAKC,MAAMC,OAAO,yBAC/B,GAAKH,EAAL,CACA,IAAMI,EAAelF,IAAEqD,OACrByB,EAAKK,WACL,SAAAC,GAAQ,OAAIA,EAASC,OAASnB,EAASF,QAA8B,WAApBoB,EAASE,UAC1DpC,KAAI,kBAAgC,CAAEnD,GAAlC,EAAGA,GAAmCJ,GAAtC,EAAO4F,UAA8C3F,GAArD,EAAkBd,WAClB0G,EAAexF,IAAEqD,OACrByB,EAAKhE,OAAO2E,KACZ,SAAAtE,GAAK,OACHA,EAAM6C,SAAWE,EAASF,OAAO0B,MAAM,IACtB,WAAjBvE,EAAMmE,QACS,UAAfnE,EAAMwE,MACNrH,KAAKkC,KAAKW,EAAMrC,UAAYR,KAAKkC,KAAK0D,EAAS5C,gBACjD4B,KAAI,kBAA4B,CAAEnD,GAA9B,EAAGA,GAA+BJ,GAAlC,EAAOO,MAAsCN,GAA7C,EAAcd,WACpBuF,EAAaa,EAAaU,OAAOJ,OAhBrC,eAqBA,4BAAQ1D,QAzCa,WACvB,IAAMhB,EFkJe,SAACkD,EAAQI,GAAT,OACvBA,EACGlB,KAAI,YAAgC,IAAzBhD,EAAwB,EAA5BP,GAAeb,EAAa,EAAjBc,GACXkF,EAAO,CACXa,KAAM,QACN3B,SACA6B,MAAO,EACP3F,MAAO4F,OAAO5F,GACdpB,OAAQgH,OAAOhH,IAEjB,MACE,cACAiG,KAAKgB,UAAU,CACbJ,KAAM,kBACNK,KAAM,CAAEC,UAAU,EAAOC,UAAU,GACnCC,QAASpB,KAAKgB,UAAU,CAAC,EAAG,KAAM,KAAMjB,MAJ1C,OASHsB,KAAK,MEtKSC,CAAUnC,EAASF,OAAQI,GAC1CkC,QAAQC,IAAIzF,GACZ0F,IAAK1F,KAsCH,eACA,kBAAC,EAAD,CAAWU,KAAM4C,EAAW/B,SFOFb,EEP2B4C,EFOlB,CACvC,CACEO,KAAM,QACNC,MAAO,YACPC,aAAc,SAACjD,GAAD,OAASf,EAAeW,EAAMA,EAAKiF,QAAQ7E,IAAM1B,QAEjE,CACEyE,KAAM,aACNC,MAAO,iBACPC,aAAc,SAACjD,GACb,IAAM8E,EAAY7F,EAAeW,EAAMA,EAAKiF,QAAQ7E,GAAO,GAAG1B,MACxDyG,EAAOD,EAAY7F,EAAeW,EAAMA,EAAKiF,QAAQ7E,IAAM1B,MAC3D0G,EAAeD,EAAOD,EAAa,IACzC,MAAM,GAAN,OAAUtI,EAAUuI,GAAQ,GAA5B,aAAmCvI,EAAUwI,GAAe,EAAG,GAA/D,QAGJ,CACEjC,KAAM,SACNC,MAAO,aACPC,aAAc,SAACjD,GAAD,OAASf,EAAeW,EAAMA,EAAKiF,QAAQ7E,IAAM9C,SAEjE,CACE6F,KAAM,KACNC,MAAO,WACPC,aAAc,SAACjD,GAAS,IAAD,EACKf,EAAeW,EAAMA,EAAKiF,QAAQ7E,IAApD1B,EADa,EACbA,MAAOpB,EADM,EACNA,OACf,OAAON,EAAQ0B,EAAOpB,KAG1B,CAAE6F,KAAM,KAAMC,MAAO,aACrB,CACED,KAAM,MACNC,MAAO,iBACPC,aAAc,SAACjD,GAAS,IACV8E,GAAclF,EAAKA,EAAKiF,QAAQ7E,GAAO,IAAM,IAAjDjC,GACFgH,EAAOD,EAAY9E,EAAIjC,GACvBiH,EAAeD,EAAOD,EAAa,IACzC,MAAM,GAAN,OAAUtI,EAAUuI,GAAQ,GAA5B,aAAmCvI,EAAUwI,GAAe,EAAG,GAA/D,QAGJ,CAAEjC,KAAM,KAAMC,MAAO,cACrB,CAAED,KAAM,KAAMC,MAAO,WAAYC,aAAc,SAACjD,GAAD,OAASpD,EAAQoD,EAAIjC,GAAIiC,EAAIhC,MAC5E,CACE+E,KAAM,KACNC,MAAO,MACPC,aAAc,SAACjD,GAAS,IAAD,EACDf,EAAeW,EAAMA,EAAKiF,QAAQ7E,IAA9C5C,EADa,EACbA,GAAIc,EADS,EACTA,IACZ,MAAM,GAAN,OAAU1B,EAAUY,EAAI,GAAxB,aAA+BZ,EAAU0B,EAAK,GAA9C,UEtDiEwC,SAAU+B,IAC3E,gCACE,8CAEF,kBAAC,EAAD,CAAW7C,KAAMgD,EAAQnC,QF6EG,CAChC,CAAEsC,KAAM,QAASC,MAAO,aACxB,CAAED,KAAM,SAAUC,MAAO,cACzB,CAAED,KAAM,YAAaC,MAAO,cAC5B,CACED,KAAM,KACNC,MAAO,MACPC,aAAc,SAACjD,GACb,IAAM5C,EAAKL,EAAciD,EAAI1B,MAAO0B,EAAI/C,UAAW+C,EAAI9C,OAAQ,MACzDgB,EAAMX,EAAqByC,EAAI1B,MAAO0B,EAAI/C,UAAW+C,EAAI9C,QAC/D,MAAM,GAAN,OAAUV,EAAUY,EAAI,GAAxB,aAA+BZ,EAAU0B,EAAK,GAA9C,SEvFkDwC,SAAUmC,MC5ElEoC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,OAEFC,SAASC,eAAe,W","file":"static/js/main.97084110.chunk.js","sourcesContent":["import _ from 'lodash'\n\nconst getDecimals = (value) => {\n  if (value < 1) return 6\n  if (value < 1000) return 2\n  if (value < 10000) return 1\n  return 0\n}\n\nexport const precision = (value, decimals = getDecimals(value)) =>\n  Math.floor(value * 10 ** decimals) / 10 ** decimals\n\nconst getCost = (p, a) => precision(p * a)\nconst getPosPrice = (pp, pa, op, oa) => precision((getCost(pp, pa) + getCost(op, oa)) / (pa + oa))\n\nexport const getPositionPL = (entryPrice, exitPrice, amount, fee) => {\n  const pl = (exitPrice - entryPrice) * amount\n  const exitFee = exitPrice * Math.abs(amount) * fee\n  return precision(pl - exitFee)\n}\n\nconst getPositionCost = (entryPrice, exitPrice, amount) => {\n  const positiveAmount = Math.abs(amount)\n  if (amount < 0) {\n    return Math.max(positiveAmount * entryPrice, positiveAmount * exitPrice, 0)\n  }\n  return Math.max(positiveAmount * entryPrice, 0)\n}\n\nexport const getPositionPLPercent = (entryPrice, exitPrice, amount) => {\n  const pl = getPositionPL(entryPrice, exitPrice, amount, 0)\n  const cost = getPositionCost(entryPrice, exitPrice, amount)\n  return pl && cost !== 0 ? (pl / cost) * 100 : 0\n}\n\nexport const getPosition = (pp, pa, op, oa) => {\n  const p = getPosPrice(pp, pa, op, oa)\n  const a = precision(pa + oa)\n  const pl = getPositionPL(p, op, a, 0.002)\n  const plp = precision(getPositionPLPercent(p, op, a))\n  return {\n    id: _.uniqueId(),\n    price: p,\n    amount: a,\n    op,\n    oa,\n    pl,\n    plp,\n  }\n}\n\nexport const getPercentPrice = (entryPrice, percent) =>\n  precision(parseFloat(entryPrice) + parseFloat(entryPrice) * (parseFloat(percent) / 100))\nexport const getPricePercent = (price, entryPrice) =>\n  precision(((parseFloat(price) - parseFloat(entryPrice)) * 100) / parseFloat(entryPrice))\n\nconst getNextPrice = (price, xPrice, sign, index) => {\n  return precision(price + sign * price * xPrice * Math.log10((index + 2) * 1.3))\n  // return precision(price + sign * price * xPrice * Math.pow(index + 1, 1 / 3))\n}\nconst getNextAmount = (amount, xAmount, index) => precision(amount * xAmount)\n\nexport const getSettingsColumns = () => [\n  { name: 'symbol', title: 'Symbol' },\n  { name: 'entryPrice', title: 'Entry Price' },\n  { name: 'entryAmount', title: 'Entry Amount' },\n  { name: 'pricePercent', title: 'Price Percent' },\n  {\n    name: 'price',\n    title: 'Price',\n    getCellValue: (row) => getPercentPrice(row.entryPrice, row.pricePercent),\n  },\n  { name: 'xPrice', title: 'x Price' },\n  { name: 'xAmount', title: 'x Amount' },\n]\n\nexport const getAvgPosition = (orders, maxIndex = orders.length - 1) =>\n  orders.reduce((acc, order, index) => {\n    if (index > maxIndex) return acc\n    const { price, amount } = _.isEmpty(acc) ? { price: 0, amount: 0 } : acc\n    return getPosition(price, amount, parseFloat(order.op), parseFloat(order.oa))\n  }, {})\n\nexport const getOrderColumns = (rows) => [\n  {\n    name: 'price',\n    title: 'Pos Price',\n    getCellValue: (row) => getAvgPosition(rows, rows.indexOf(row)).price,\n  },\n  {\n    name: 'price diff',\n    title: 'Pos Price diff',\n    getCellValue: (row) => {\n      const prevPrice = getAvgPosition(rows, rows.indexOf(row) - 1).price\n      const diff = prevPrice - getAvgPosition(rows, rows.indexOf(row)).price\n      const diffPercent = (diff / prevPrice) * 100\n      return `${precision(diff || 0)} (${precision(diffPercent || 0, 2)}%)`\n    },\n  },\n  {\n    name: 'amount',\n    title: 'Pos Amount',\n    getCellValue: (row) => getAvgPosition(rows, rows.indexOf(row)).amount,\n  },\n  {\n    name: 'pc',\n    title: 'Pos Cost',\n    getCellValue: (row) => {\n      const { price, amount } = getAvgPosition(rows, rows.indexOf(row))\n      return getCost(price, amount)\n    },\n  },\n  { name: 'op', title: 'Ord Price' },\n  {\n    name: 'opp',\n    title: 'Ord Price diff',\n    getCellValue: (row) => {\n      const { op: prevPrice } = rows[rows.indexOf(row) - 1] || {}\n      const diff = prevPrice - row.op\n      const diffPercent = (diff / prevPrice) * 100\n      return `${precision(diff || 0)} (${precision(diffPercent || 0, 2)}%)`\n    },\n  },\n  { name: 'oa', title: 'Ord Amount' },\n  { name: 'oc', title: 'Ord Cost', getCellValue: (row) => getCost(row.op, row.oa) },\n  {\n    name: 'pl',\n    title: 'P/L',\n    getCellValue: (row) => {\n      const { pl, plp } = getAvgPosition(rows, rows.indexOf(row))\n      return `${precision(pl, 3)} (${precision(plp, 2)}%)`\n    },\n  },\n]\n\nexport const getOrderRows = ({\n  entryPrice = 6046.3,\n  entryAmount = 0.001,\n  pricePercent = -10,\n  xPrice = 0.009,\n  xAmount = 1.35,\n}) => {\n  const rows = []\n\n  let price = parseFloat(entryPrice)\n  let amount = parseFloat(entryAmount)\n  const sign = Math.sign(pricePercent)\n  const endPrice = getPercentPrice(parseFloat(entryPrice), parseFloat(pricePercent))\n  while (price * sign < sign * endPrice) {\n    rows.push({ id: _.uniqueId(), op: price, oa: amount })\n    const index = rows.length - 1\n    price = getNextPrice(price, xPrice, sign, index)\n    amount = getNextAmount(amount, xAmount, index)\n  }\n  return rows\n}\n\nexport const getPlColumns = () => [\n  { name: 'price', title: 'Pos Price' },\n  { name: 'amount', title: 'Pos Amount' },\n  { name: 'exitPrice', title: 'Exit Price' },\n  {\n    name: 'pl',\n    title: 'P/L',\n    getCellValue: (row) => {\n      const pl = getPositionPL(row.price, row.exitPrice, row.amount, 0.002)\n      const plp = getPositionPLPercent(row.price, row.exitPrice, row.amount)\n      return `${precision(pl, 3)} (${precision(plp, 2)}%)`\n    },\n  },\n]\n\nexport const getPlRows = (orderRows) => {\n  const pos = getAvgPosition(orderRows)\n  return [\n    { id: 'exit1', price: pos.price, amount: pos.amount, exitPrice: getPercentPrice(pos.price, 1) },\n    { id: 'exit2', price: pos.price, amount: pos.amount, exitPrice: getPercentPrice(pos.price, 2) },\n    { id: 'exit3', price: pos.price, amount: pos.amount, exitPrice: getPercentPrice(pos.price, 3) },\n  ]\n}\n\nexport const getOrders = (symbol, orderRows) =>\n  orderRows\n    .map(({ op: price, oa: amount }) => {\n      const data = {\n        type: 'LIMIT',\n        symbol,\n        flags: 0,\n        price: String(price),\n        amount: String(amount),\n      }\n      return (\n        `__dispatch(` +\n        JSON.stringify({\n          type: 'WS_REQUEST_SEND',\n          meta: { isPublic: false, throttle: true },\n          payload: JSON.stringify([0, 'on', null, data]),\n        }) +\n        `)`\n      )\n    })\n    .join('\\n')\n","import React, { useState, useEffect } from 'react'\nimport { EditingState } from '@devexpress/dx-react-grid'\nimport {\n  Grid,\n  Table,\n  TableHeaderRow,\n  TableEditColumn,\n  TableInlineCellEditing,\n} from '@devexpress/dx-react-grid-material-ui'\n\nconst getRowId = row => row.id\n\nconst FocusableCell = ({ onClick, ...restProps }) => (\n  <Table.Cell {...restProps} tabIndex={0} onFocus={onClick} />\n)\n\nfunction TableEdit({ rows: initRows, columns, onChange = () => {} }) {\n  const [rows, setRows] = useState(initRows)\n  const [editingCells, setEditingCells] = useState([])\n\n  useEffect(() => {\n    setRows(initRows)\n  }, [initRows])\n\n  const commitChanges = ({ added, changed, deleted }) => {\n    let changedRows\n    if (added) {\n      const startingAddedId = rows.length > 0 ? rows[rows.length - 1].id + 1 : 0\n      changedRows = [\n        ...rows,\n        ...added.map((row, index) => ({\n          id: startingAddedId + index,\n          ...row,\n        })),\n      ]\n    }\n    if (changed) {\n      changedRows = rows.map(row => (changed[row.id] ? { ...row, ...changed[row.id] } : row))\n    }\n    if (deleted) {\n      const deletedSet = new Set(deleted)\n      changedRows = rows.filter(row => !deletedSet.has(row.id))\n    }\n    setRows(changedRows)\n    onChange(changedRows)\n  }\n\n  const addEmptyRow = () => commitChanges({ added: [{}] })\n\n  return (\n    <Grid rows={rows} columns={columns} getRowId={getRowId}>\n      <EditingState\n        onCommitChanges={commitChanges}\n        editingCells={editingCells}\n        onEditingCellsChange={setEditingCells}\n        addedRows={[]}\n        onAddedRowsChange={addEmptyRow}\n      />\n      <Table cellComponent={FocusableCell} />\n      <TableHeaderRow />\n      <TableInlineCellEditing selectTextOnEditStart />\n      <TableEditColumn showAddCommand showDeleteCommand />\n    </Grid>\n  )\n}\n\nexport default TableEdit\n","import React, { useState, useEffect } from 'react'\nimport copy from 'copy-to-clipboard'\nimport _ from 'lodash'\n\nimport {\n  getSettingsColumns,\n  getOrderColumns,\n  getOrderRows,\n  getPlColumns,\n  getPlRows,\n  getOrders,\n} from './functions'\nimport TableEdit from './TableEdit'\n\nfunction App() {\n  const [settings, setSettings] = useState({\n    id: 'settings',\n    symbol: 'tBTCEUR',\n    entryPrice: 6046.3,\n    entryAmount: 0.005,\n    pricePercent: -10,\n    xPrice: 0.011,\n    xPositionAmount: 0,\n    xAmount: 1.2,\n  })\n  const [orderRows, setOrderRows] = useState(getOrderRows(settings))\n  const [plRows, setPlRows] = useState(getPlRows(orderRows))\n\n  useEffect(() => {\n    setOrderRows(getOrderRows(settings))\n  }, [settings])\n\n  const settingsColumns = getSettingsColumns()\n\n  const handleCopyOrders = () => {\n    const orders = getOrders(settings.symbol, orderRows)\n    console.log(orders)\n    copy(orders)\n  }\n\n  return (\n    <div>\n      <center>\n        <h3>Settings</h3>\n      </center>\n      <TableEdit\n        rows={[settings]}\n        columns={settingsColumns}\n        onChange={rows => setSettings(rows[0])}\n      />\n      <center>\n        <h3>Positions / Orders</h3>\n      </center>\n      <button onClick={() => setOrderRows([])}>Clear positions / orders</button>\n      <button\n        onClick={() => {\n          const data = JSON.parse(prompt('copy(__state().data)'))\n          if (!data) return\n          const positionRows = _.filter(\n            data.positions,\n            position => position.pair === settings.symbol && position.status === 'ACTIVE',\n          ).map(({ id, basePrice, amount }) => ({ id, op: basePrice, oa: amount }))\n          const newOrderRows = _.filter(\n            data.orders.all,\n            order =>\n              order.symbol === settings.symbol.slice(1) &&\n              order.status === 'ACTIVE' &&\n              order.type === 'LIMIT' &&\n              Math.sign(order.amount) === Math.sign(settings.entryAmount),\n          ).map(({ id, price, amount }) => ({ id, op: price, oa: amount }))\n          setOrderRows(positionRows.concat(newOrderRows))\n        }}\n      >\n        Import Data\n      </button>\n      <button onClick={handleCopyOrders}>Copy orders</button>\n      <TableEdit rows={orderRows} columns={getOrderColumns(orderRows)} onChange={setOrderRows} />\n      <center>\n        <h3>Profit / Loss</h3>\n      </center>\n      <TableEdit rows={plRows} columns={getPlColumns()} onChange={setPlRows} />\n    </div>\n  )\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n)\n"],"sourceRoot":""}